<!doctype html>



  


<html class="theme-next muse use-motion">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />












  <link href="/vendors/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css"/>




  <link href="//fonts.googleapis.com/css?family=Lato:300,400,700,400italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">



<link href="/vendors/font-awesome/css/font-awesome.min.css?v=4.4.0" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=0.5.0" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=0.5.0" />






<meta name="description">
<meta property="og:type" content="website">
<meta property="og:title" content="Jiatian Tian">
<meta property="og:url" content="http://onlytjt.github.io/index.html">
<meta property="og:site_name" content="Jiatian Tian">
<meta property="og:description">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Jiatian Tian">
<meta name="twitter:description">



<script type="text/javascript" id="hexo.configuration">
  var NexT = window.NexT || {};
  var CONFIG = {
    scheme: 'Muse',
    sidebar: {"position":"left","display":"post"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: 0,
      author: 'Author'
    }
  };
</script>

  <title> Jiatian Tian </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="">

  










  
  
    
  

  <div class="container one-collumn sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">Jiatian Tian</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle">Work hard! Play hard!</p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-home fa-fw"></i> <br />
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-archive fa-fw"></i> <br />
            
            Archives
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-tags fa-fw"></i> <br />
            
            Tags
          </a>
        </li>
      

      
    </ul>
  

  
</nav>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/03/18/Android入门1：使用VideoView和MediController播放视频/" itemprop="url">
                  Android入门1：使用VideoView和MediController播放视频
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">Posted on</span>
            <time itemprop="dateCreated" datetime="2016-03-18T13:43:41+08:00" content="2016-03-18">
              2016-03-18
            </time>
          </span>

          

          
            
          

          

          
          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <p>最近在搞Android，入门曲线还是挺陡峭的，主要还是自己对Java的理解不够深入。前后学习了几天，把最近学习到的一些知识点总结归纳一下，正所谓温故而知新。</p>
<p>目前想搞一个禁播视频站，主要内容都是一些大陆被墙的动漫啊，美剧啥的，比如我最爱的死亡笔记。内容不包含18禁的~感觉有些小伙伴要失望咯。</p>
          <div class="post-more-link text-center">
            <a class="btn" href="/2016/03/18/Android入门1：使用VideoView和MediController播放视频/#more" rel="contents">
              Read more &raquo;
            </a>
          </div>
        
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/03/18/hello-world/" itemprop="url">
                  Hello World
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">Posted on</span>
            <time itemprop="dateCreated" datetime="2016-03-18T12:35:11+08:00" content="2016-03-18">
              2016-03-18
            </time>
          </span>

          

          
            
          

          

          
          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>Welcome to <a href="https://hexo.io/" target="_blank" rel="external">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/" target="_blank" rel="external">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html" target="_blank" rel="external">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues" target="_blank" rel="external">GitHub</a>.</p>
<h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">"My New Post"</span></span><br></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/writing.html" target="_blank" rel="external">Writing</a></p>
<h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/server.html" target="_blank" rel="external">Server</a></p>
<h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/generating.html" target="_blank" rel="external">Generating</a></p>
<h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/deployment.html" target="_blank" rel="external">Deployment</a></p>

          
        
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/03/14/Android3_Toolbar/" itemprop="url">
                  Untitled
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">Posted on</span>
            <time itemprop="dateCreated" datetime="2016-03-14T15:16:07+08:00" content="2016-03-14">
              2016-03-14
            </time>
          </span>

          

          
            
          

          

          
          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="从Android-Toolbar到Material-Design"><a href="#从Android-Toolbar到Material-Design" class="headerlink" title="从Android Toolbar到Material Design"></a>从Android Toolbar到Material Design</h3><p>在Android5.0(API 21)之后，Toolbar被Google推广，逐渐走入大家视野。具体关于Actionbar和Toolbar的对比就不多啰嗦了，跟着潮流走是没错的。下面先上张简单的效果图，这是我近期在构思的一个app，帮助我们搜集宣讲会、实习、工作信息。</p>
<p><img src="https://raw.githubusercontent.com/onlytjt/MarkdownSource/master/pic/Android3_1.png" alt="Android Toolbar效果图"></p>
<p>####1. 初识Material Theme</p>
<p><img src="https://raw.githubusercontent.com/onlytjt/MarkdownSource/master/pic/Android3_2.png" alt="Material Theme"></p>
<p>为了使用Material Design相关资源，新建工程时需要注意Min SDK需要大于等于API21。我们先来了解一下Material Theme。如上图所示，可以进行设置的部分有：</p>
<ul>
<li>colorPrimary：Toolbar的主体颜色</li>
<li>colorPrimaryDark：Toolbar上方的背景颜色，一般为深色，会是的app看起来更有层次感</li>
<li>textColorPrimary：Toolbar的title文字颜色</li>
</ul>
<p>剩下的参数也很明了了。这里所有的属性后面都跟了一个”Primary”是因为，Toolbar不仅可以在xml中出现，还能够在view中进行任意的设置，而且还可以将其当做一个Actionbar来使用~</p>
<p>###2. 自定义Theme</p>
<p>在<code>/res/values/</code>文件夹下我们需要新建3个xml文件</p>
<ul>
<li>my_theme.xml：用于自定义主题，配置主题中我们所需要的颜色</li>
<li>default_colors_setting.xml：将颜色建立别名，方便引用和修改</li>
<li>android_material_design_colors.xml：调色板，用于存储一些色彩</li>
</ul>
<p>关于android_material_design_colors.xml，我直接下载了google给出的色彩调色方案，添加到工程中，可以直接引用其中的颜色。下载地址：<a href="https://gist.github.com/daniellevass/b0b8cfa773488e138037。另外有一个比较不错的网站，[Material" target="_blank" rel="external">https://gist.github.com/daniellevass/b0b8cfa773488e138037。另外有一个比较不错的网站，[Material</a> Palette](<a href="https://gist.github.com/daniellevass/b0b8cfa773488e138037" target="_blank" rel="external">https://gist.github.com/daniellevass/b0b8cfa773488e138037</a>) 可以在线预览我们的颜色搭配，小伙伴们不妨都去试试，能给设计省下不少时间~</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">/res/values/default_colors_setting.mxl</span><br><span class="line">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span><br><span class="line"><span class="comment">&lt;!-- 主要目的是给常用颜色设置别名，方便引用和更改 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">resources</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">"color_primary"</span>&gt;</span>@color/md_light_blue_400<span class="tag">&lt;/<span class="name">color</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">"color_primary_dark"</span>&gt;</span>@color/md_light_blue_700<span class="tag">&lt;/<span class="name">color</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">"color_primary_text"</span>&gt;</span>@android:color/white<span class="tag">&lt;/<span class="name">color</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">resources</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">/res/values/my_theme.xml</span><br><span class="line">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span><br><span class="line"><span class="tag">&lt;<span class="name">resources</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span> <span class="attr">name</span>=<span class="string">"MyMaterialTheme"</span> <span class="attr">parent</span>=<span class="string">"MyMaterialTheme.Base"</span>&gt;</span><span class="undefined"></span><br><span class="line">    </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span> <span class="attr">name</span>=<span class="string">"MyMaterialTheme.Base"</span> <span class="attr">parent</span>=<span class="string">"Theme.AppCompat"</span>&gt;</span><span class="xml"></span><br><span class="line">      	<span class="comment">&lt;!-- 移除Actionbar，以下两句缺一不可 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">item</span> <span class="attr">name</span>=<span class="string">"windowNoTitle"</span>&gt;</span>true<span class="tag">&lt;/<span class="name">item</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">item</span> <span class="attr">name</span>=<span class="string">"windowActionBar"</span>&gt;</span>false<span class="tag">&lt;/<span class="name">item</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- Toolbar主体颜色 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">item</span> <span class="attr">name</span>=<span class="string">"android:colorPrimary"</span>&gt;</span>@color/color_primary<span class="tag">&lt;/<span class="name">item</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- Toolbar上方的背景颜色,一般比主体颜色深 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">item</span> <span class="attr">name</span>=<span class="string">"android:colorPrimaryDark"</span>&gt;</span>@color/color_primary_dark<span class="tag">&lt;/<span class="name">item</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 其他可以使用的属性参数:colorAccent, colorControlNormal,</span><br><span class="line">        colorControlActivated, colorControlHighlight, colorSwitchThumbNormal --&gt;</span></span><br><span class="line">    </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">resources</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>完成了我们自己的Theme，接下来我们要在app中使用我们的Theme，修改<code>/res/AndroidManifest.xml</code></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">application</span></span><br><span class="line">        <span class="attr">android:allowBackup</span>=<span class="string">"true"</span></span><br><span class="line">        <span class="attr">android:icon</span>=<span class="string">"@mipmap/ic_launcher"</span></span><br><span class="line">        <span class="attr">android:label</span>=<span class="string">"@string/app_name"</span></span><br><span class="line">        <span class="attr">android:theme</span>=<span class="string">"@style/MyMaterialTheme"</span> &gt;</span></span><br><span class="line">......</span><br></pre></td></tr></table></figure>
<p>此时运行程序，便可以看到我们自定义的主题已经生效，但此时app的上方还是空空如也，应为我们还没有为其添加Toolbar。</p>
<p><img src="https://raw.githubusercontent.com/onlytjt/MarkdownSource/master/pic/Android3_3.png" alt=""></p>
<h4 id="3-添加Toolbar"><a href="#3-添加Toolbar" class="headerlink" title="3. 添加Toolbar"></a>3. 添加Toolbar</h4><p>首先我们要给Toolbal新建一个布局文件，/res/layout/toolbar.xml。这里使用v7包中的Toolbar。使用gradle的同学记得添加依赖。<code>compile &#39;com.android.support:appcompat-v7:23.1.1&#39;</code></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span><br><span class="line"><span class="tag">&lt;<span class="name">android:android.support.v7.widget.Toolbar</span></span><br><span class="line">        <span class="attr">xmlns:android</span>=<span class="string">"http://schemas.android.com/apk/res/android"</span></span><br><span class="line">        <span class="attr">android:id</span>=<span class="string">"@+id/toolbar"</span></span><br><span class="line">        <span class="attr">android:layout_height</span>=<span class="string">"wrap_content"</span></span><br><span class="line">        <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></span><br><span class="line">        <span class="attr">android:minHeight</span>=<span class="string">"?attr/actionBarSize"</span></span><br><span class="line">        <span class="attr">android:background</span>=<span class="string">"@color/color_primary"</span></span><br><span class="line">/&gt;</span></span><br></pre></td></tr></table></figure>
<p>然后我们在主布局文件中引入toolbar，/res/layout/activity_main.xml</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">LinearLayout</span> <span class="attr">xmlns:android</span>=<span class="string">"http://schemas.android.com/apk/res/android"</span></span><br><span class="line">                <span class="attr">xmlns:tools</span>=<span class="string">"http://schemas.android.com/tools"</span></span><br><span class="line">                <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></span><br><span class="line">                <span class="attr">android:layout_height</span>=<span class="string">"match_parent"</span></span><br><span class="line">                <span class="attr">android:orientation</span>=<span class="string">"vertical"</span></span><br><span class="line">                <span class="attr">tools:context</span>=<span class="string">".MainActivity"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">include</span></span><br><span class="line">        <span class="attr">android:id</span>=<span class="string">"@+id/toolbar"</span></span><br><span class="line">        <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></span><br><span class="line">        <span class="attr">android:layout_height</span>=<span class="string">"wrap_content"</span></span><br><span class="line">        <span class="attr">android:layout_alignParentTop</span>=<span class="string">"true"</span></span><br><span class="line">        <span class="attr">layout</span>=<span class="string">"@layout/toolbar"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">TextView</span></span><br><span class="line">            <span class="attr">android:text</span>=<span class="string">"@string/hello_world"</span></span><br><span class="line">            <span class="attr">android:layout_width</span>=<span class="string">"wrap_content"</span></span><br><span class="line">            <span class="attr">android:layout_height</span>=<span class="string">"wrap_content"</span></span><br><span class="line">            <span class="attr">android:layout_below</span>=<span class="string">"@+id/toolbar"</span></span><br><span class="line">    /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>最后，我们在<code>onCreate()</code>中进行设置。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState);</span><br><span class="line">        setContentView(R.layout.activity_main);</span><br><span class="line"></span><br><span class="line">      	<span class="keyword">private</span> Toolbar mToolbar;</span><br><span class="line">    	<span class="keyword">private</span> ActionBar mActionbar;</span><br><span class="line"></span><br><span class="line">        mToolbar = (Toolbar) findViewById(R.id.toolbar);</span><br><span class="line">        setSupportActionBar(mToolbar);</span><br><span class="line">        mActionbar = getSupportActionBar();  <span class="comment">// 转换为Actionbar操作</span></span><br><span class="line">        mActionbar.setTitle(<span class="string">"爱实习  爱工作"</span>);  <span class="comment">// 设置toolbar标题</span></span><br><span class="line">      	<span class="comment">// 设置toolbar左侧icon，也成为Navigation Icon</span></span><br><span class="line">        mToolbar.setNavigationIcon(R.mipmap.ic_menu_white_36dp); </span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>完成以上步骤就可以得到最终的效果图啦。</p>
<p>这里还想推荐给小伙伴的是github上的一个开源项目：<a href="https://github.com/mikepenz/Android-Iconics" target="_blank" rel="external">mikepenz/Android-Iconics</a>。这里有许许多多基于Material Design的icon，貌似这是个大神~他的SlideMenu的插件也很好用。希望能给小伙伴省下一些寻找资源的时间，开发更加顺利。</p>
<p><img src="https://raw.githubusercontent.com/onlytjt/MarkdownSource/master/pic/Android3_4.jpg" alt=""></p>
<hr>
<p><strong>By tjt</strong></p>
<p><strong>2016.03.14</strong></p>

          
        
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2015/12/08/Android2_Adapter/" itemprop="url">
                  Untitled
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">Posted on</span>
            <time itemprop="dateCreated" datetime="2015-12-08T21:40:23+08:00" content="2015-12-08">
              2015-12-08
            </time>
          </span>

          

          
            
          

          

          
          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="Android入门2：从GridView控件使用到自定义Adapter"><a href="#Android入门2：从GridView控件使用到自定义Adapter" class="headerlink" title="Android入门2：从GridView控件使用到自定义Adapter"></a>Android入门2：从GridView控件使用到自定义Adapter</h3><p>在日常手机app的使用中，出现频率最高的便是ListView和GridView。ListView的例子是微信主界面，而GridView的例子则是支付宝的主界面，不明白的小伙伴打开手机便一目了然。然而这两个控件同时也称成为最难使用的控件，由于两个控件使用方法完全相同，今天博主以GridView为例，讲一讲我和它的故事。</p>
<h4 id="1-小白初探–使用SimpleAdapter加载本地资源"><a href="#1-小白初探–使用SimpleAdapter加载本地资源" class="headerlink" title="1. 小白初探–使用SimpleAdapter加载本地资源"></a>1. 小白初探–使用SimpleAdapter加载本地资源</h4><p>单纯学习使用GridView还是很简单的，只需要使用一个数据适配器将所需要显示的数据资源(包括图像和文本)，与布局文件中的控件连接起来即可。</p>
<p><img src="https://raw.githubusercontent.com/onlytjt/MarkdownSource/master/pic/Android2_1.png" alt="Android2_1" title="数据适配器"></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">// activity_gridview.xml</span><br><span class="line"><span class="tag">&lt;<span class="name">RelativeLayout</span> <span class="attr">xmlns:android</span>=<span class="string">"http://schemas.android.com/apk/res/android"</span></span><br><span class="line">                <span class="attr">xmlns:tools</span>=<span class="string">"http://schemas.android.com/tools"</span></span><br><span class="line">                <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></span><br><span class="line">                <span class="attr">android:layout_height</span>=<span class="string">"match_parent"</span></span><br><span class="line">                <span class="attr">android:paddingLeft</span>=<span class="string">"@dimen/activity_horizontal_margin"</span></span><br><span class="line">                <span class="attr">android:paddingRight</span>=<span class="string">"@dimen/activity_horizontal_margin"</span></span><br><span class="line">                <span class="attr">android:paddingTop</span>=<span class="string">"@dimen/activity_vertical_margin"</span></span><br><span class="line">                <span class="attr">android:paddingBottom</span>=<span class="string">"@dimen/activity_vertical_margin"</span></span><br><span class="line">                <span class="attr">tools:context</span>=<span class="string">"edu.sjtu.helloworld.app.GridviewActivity"</span></span><br><span class="line">                <span class="attr">android:id</span>=<span class="string">"@+id/grid"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">GridView</span></span><br><span class="line">            <span class="attr">android:id</span>=<span class="string">"@+id/grid_test"</span></span><br><span class="line">            <span class="attr">android:numColumns</span>=<span class="string">"auto_fit"</span></span><br><span class="line">            <span class="attr">android:horizontalSpacing</span>=<span class="string">"10dp"</span></span><br><span class="line">            <span class="attr">android:layout_width</span>=<span class="string">"wrap_content"</span></span><br><span class="line">            <span class="attr">android:layout_height</span>=<span class="string">"wrap_content"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">GridView</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">RelativeLayout</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">// grid_item.xml</span><br><span class="line">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span><br><span class="line"><span class="tag">&lt;<span class="name">LinearLayout</span> <span class="attr">xmlns:android</span>=<span class="string">"http://schemas.android.com/apk/res/android"</span></span><br><span class="line">              <span class="attr">android:orientation</span>=<span class="string">"vertical"</span></span><br><span class="line">              <span class="attr">android:gravity</span>=<span class="string">"center"</span></span><br><span class="line">              <span class="attr">android:background</span>=<span class="string">"#ffffff"</span></span><br><span class="line">              <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></span><br><span class="line">              <span class="attr">android:layout_height</span>=<span class="string">"match_parent"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">ImageView</span></span><br><span class="line">            <span class="attr">android:id</span>=<span class="string">"@+id/img_item"</span></span><br><span class="line">            <span class="attr">android:src</span>=<span class="string">"@mipmap/ic_launcher"</span></span><br><span class="line">            <span class="attr">android:layout_width</span>=<span class="string">"wrap_content"</span></span><br><span class="line">            <span class="attr">android:layout_height</span>=<span class="string">"wrap_content"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">TextView</span></span><br><span class="line">            <span class="attr">android:id</span>=<span class="string">"@+id/txt_item"</span></span><br><span class="line">            <span class="attr">android:textColor</span>=<span class="string">"#000000"</span></span><br><span class="line">            <span class="attr">android:text</span>=<span class="string">"文字区域"</span></span><br><span class="line">            <span class="attr">android:layout_width</span>=<span class="string">"wrap_content"</span></span><br><span class="line">            <span class="attr">android:layout_height</span>=<span class="string">"wrap_content"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// GridViewActivity.java</span></span><br><span class="line"><span class="keyword">package</span> edu.sjtu.helloworld.app;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> android.content.Intent;</span><br><span class="line"><span class="keyword">import</span> android.net.Uri;</span><br><span class="line"><span class="keyword">import</span> android.support.v7.app.AppCompatActivity;</span><br><span class="line"><span class="keyword">import</span> android.os.Bundle;</span><br><span class="line"><span class="keyword">import</span> android.view.Menu;</span><br><span class="line"><span class="keyword">import</span> android.view.MenuItem;</span><br><span class="line"><span class="keyword">import</span> android.view.View;</span><br><span class="line"><span class="keyword">import</span> android.widget.*;</span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">GridviewActivity</span> <span class="keyword">extends</span> <span class="title">AppCompatActivity</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> GridView grid_test;</span><br><span class="line">    <span class="keyword">private</span> List&lt;Map&lt;String, Object&gt;&gt; dataList;</span><br><span class="line">    <span class="keyword">private</span> SimpleAdapter simpAdapter;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span>[] img = &#123;R.mipmap.conan, R.mipmap.death_note,</span><br><span class="line">        R.mipmap.naruto, R.mipmap.one_piece&#125;;</span><br><span class="line">    <span class="keyword">private</span> String[] imgName = &#123;<span class="string">"conan"</span>, <span class="string">"death_note"</span>, <span class="string">"naruto"</span>, <span class="string">"one_piece"</span>&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState);</span><br><span class="line">        setContentView(R.layout.activity_gridview);</span><br><span class="line"></span><br><span class="line">        grid_test = (GridView) findViewById(R.id.grid_test); <span class="comment">// step1</span></span><br><span class="line">        dataList = <span class="keyword">new</span> ArrayList&lt;Map&lt;String, Object&gt;&gt;(); <span class="comment">// step2</span></span><br><span class="line">        simpAdapter = <span class="keyword">new</span> SimpleAdapter(<span class="keyword">this</span>, getData(), R.layout.grid_item, </span><br><span class="line">            <span class="keyword">new</span> String[]&#123;<span class="string">"img"</span>, <span class="string">"txt"</span>&#125;, <span class="keyword">new</span> <span class="keyword">int</span>[]&#123;R.id.img_item, R.id.txt_item&#125;);</span><br><span class="line">        grid_test.setAdapter(simpAdapter); <span class="comment">// step3</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> List&lt;Map&lt;String, Object&gt;&gt; getData() &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;img.length; i++) &#123;</span><br><span class="line">            Map&lt;String, Object&gt; map = <span class="keyword">new</span> HashMap&lt;String, Object&gt;();</span><br><span class="line">            map.put(<span class="string">"img"</span>, img[i]);</span><br><span class="line">            map.put(<span class="string">"txt"</span>, imgName[i]);</span><br><span class="line">            dataList.add(map);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> dataList;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>以上代码实现GridView主要分为3步。  </p>
<p>step1：将GridView控件与xml连接。  </p>
<p>step2：根据xml中想要显示的数据格式，初始化数据源，并使用<code>getData()</code>函数把本地数据添加到数据源中。这里的数据是一个List，List中每一条对应GridView的一块区域(也就是ListView中的一行)。List中存放的是一个Map泛型，其中的数据与想要显示的内容一一对应。  </p>
<p>step3：给GirdView设置相应的数据适配器。  </p>
<p>经过以上3步，可以很简单地把自己想要显示的本地资源，静态加载出来。效果如下图。</p>
<p><img src="https://raw.githubusercontent.com/onlytjt/MarkdownSource/master/pic/Android2_2.png" alt="Android2_2" title="GridView静态加载本地资源效果"></p>
<h4 id="2-招式进阶–定制自己的数据适配器Adapter"><a href="#2-招式进阶–定制自己的数据适配器Adapter" class="headerlink" title="2. 招式进阶–定制自己的数据适配器Adapter"></a>2. 招式进阶–定制自己的数据适配器Adapter</h4><p>当我们需要处理较为复杂的界面，加载接收多种信息时，Android提供给我们的数据适配器往往会显得苍白无力。因此我们会根据自己的需要定义数据适配器。xml文件布局同上。  </p>
<p>首先看一下Android中所有有关Adapter的接口和类的继承关系。我们选择继承ArrayAdapter来写我们自己的适配器。</p>
<p><img src="https://raw.githubusercontent.com/onlytjt/MarkdownSource/master/pic/Android2_3.jpg" alt="Android2_3" title="Adapter适配器继承关系"></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyAdapter</span> <span class="keyword">extends</span> <span class="title">ArrayAdapter</span>&lt;<span class="title">GridItem</span>&gt; </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Context mContext;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">MyAdapter</span><span class="params">(Context context)</span> </span>&#123;</span><br><span class="line">    	<span class="keyword">this</span>.context = context;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getCount</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>; <span class="comment">// 返回Adapter中数据集的条目数</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">getItem</span><span class="params">(<span class="keyword">int</span> position)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>; <span class="comment">// 获取数据集中与指定索引对应的数据项</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">long</span> <span class="title">getItemId</span><span class="params">(<span class="keyword">int</span> position)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>; <span class="comment">// 取在列表中与指定索引对应的行id</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> View <span class="title">getView</span><span class="params">(<span class="keyword">int</span> position, View convertView, ViewGroup parent)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// GridItem.java</span></span><br><span class="line"><span class="keyword">package</span> cn.edu.sjtu.videoplayer.bannedplayer02;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">GridItem</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String image;</span><br><span class="line">    <span class="keyword">private</span> String title;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">GridItem</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getImage</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> image;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setImage</span><span class="params">(String image)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.image = image;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getTitle</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> title;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setTitle</span><span class="params">(String title)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.title = title;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// GridViewAdapter.java</span></span><br><span class="line"><span class="keyword">package</span> cn.edu.sjtu.videoplayer.bannedplayer02;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> android.app.Activity;</span><br><span class="line"><span class="keyword">import</span> android.content.Context;</span><br><span class="line"><span class="keyword">import</span> android.view.LayoutInflater;</span><br><span class="line"><span class="keyword">import</span> android.view.View;</span><br><span class="line"><span class="keyword">import</span> android.view.ViewGroup;</span><br><span class="line"><span class="keyword">import</span> android.widget.ArrayAdapter;</span><br><span class="line"><span class="keyword">import</span> android.widget.ImageView;</span><br><span class="line"><span class="keyword">import</span> android.widget.TextView;</span><br><span class="line"><span class="keyword">import</span> com.squareup.picasso.Picasso;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span><br><span class="line"> * Created by tian on 12/7/15.</span><br><span class="line"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">GridViewAdapter</span> <span class="keyword">extends</span> <span class="title">ArrayAdapter</span>&lt;<span class="title">GridItem</span>&gt; </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Context mContext;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> layoutResourceId;</span><br><span class="line">    <span class="keyword">private</span> ArrayList&lt;GridItem&gt; mGridData = <span class="keyword">new</span> ArrayList&lt;GridItem&gt;();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">GridViewAdapter</span><span class="params">(Context context, <span class="keyword">int</span> resource, ArrayList&lt;GridItem&gt; objects)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(context, resource, objects);</span><br><span class="line">        <span class="keyword">this</span>.mContext = context;</span><br><span class="line">        <span class="keyword">this</span>.layoutResourceId = resource;</span><br><span class="line">        <span class="keyword">this</span>.mGridData = objects;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setGridData</span><span class="params">(ArrayList&lt;GridItem&gt; mGridData)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.mGridData = mGridData;</span><br><span class="line">        notifyDataSetChanged();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> View <span class="title">getView</span><span class="params">(<span class="keyword">int</span> position, View convertView, ViewGroup parent)</span> </span>&#123;</span><br><span class="line">        ViewHolder holder;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (convertView == <span class="keyword">null</span>) &#123;</span><br><span class="line">            LayoutInflater inflater = ((Activity)mContext).getLayoutInflater();</span><br><span class="line">            convertView = inflater.inflate(layoutResourceId, parent, <span class="keyword">false</span>);</span><br><span class="line">            holder = <span class="keyword">new</span> ViewHolder();</span><br><span class="line">            holder.textView = (TextView) convertView.findViewById(R.id.textview_item);</span><br><span class="line">            holder.imageView = (ImageView) convertView.findViewById(R.id.imgview_item);</span><br><span class="line">            convertView.setTag(holder);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            holder = (ViewHolder) convertView.getTag();</span><br><span class="line">        &#125;</span><br><span class="line">        GridItem item = mGridData.get(position);</span><br><span class="line">        holder.textView.setText(item.getTitle());</span><br><span class="line">        Picasso.with(mContext).load(item.getImage()).into(holder.imageView);</span><br><span class="line">        <span class="keyword">return</span> convertView;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="class"><span class="keyword">class</span> <span class="title">ViewHolder</span> </span>&#123;</span><br><span class="line">        TextView textView;</span><br><span class="line">        ImageView imageView;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这里需要重点讲也是必须重写的是<code>getView()</code>方法。首先我们重复使用缓存convertView，如果缓存区已经存在View对象，我们则不再重新创建。同时，我们也使用ViewHolder对实例化后的控件进行暂存，因为<code>findViewById</code>方法的查找是很费内存的。如果一个Item中有许多内容，每次的查找过程将耗费我们众多的时间。虽然我还是小白一个，但是一定要有一颗大神的心，代码要写效率高的(笑)。  </p>
<p>在这里我其实是有一些疑问的，在这个类的代码中，我们看到了控件和Adapter的绑定过程，也看到了Adapter向控件(TextView, ImageView)写入我们的资源，但是并没有看到将数据源设置到Adapter的具体代码。关于这个问题，大家可以在文章最后附上的一些链接中找寻答案，也可以打开源码自己分析。鉴于篇幅问题，本篇文章暂不对此问题进行深入探讨，后面我应该会写一遍关于Adapter实现机理和源码分析的blog，嘛，都是后话了。在对ImageView的设置中，为了简化代码，这里我使用了一个第三方库–Picasso，用于下载并缓存网络图片。这也不是本文重点，这几天我同时也在针对网络的异步请求准备材料，相关的文章很快就能写出来。  </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.edu.sjtu.videoplayer.bannedplayer02;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> android.graphics.Bitmap;</span><br><span class="line"><span class="keyword">import</span> android.graphics.BitmapFactory;</span><br><span class="line"><span class="keyword">import</span> android.media.Image;</span><br><span class="line"><span class="keyword">import</span> android.os.AsyncTask;</span><br><span class="line"><span class="keyword">import</span> android.os.Handler;</span><br><span class="line"><span class="keyword">import</span> android.os.Message;</span><br><span class="line"><span class="keyword">import</span> android.support.v7.app.AppCompatActivity;</span><br><span class="line"><span class="keyword">import</span> android.os.Bundle;</span><br><span class="line"><span class="keyword">import</span> android.view.Menu;</span><br><span class="line"><span class="keyword">import</span> android.view.MenuItem;</span><br><span class="line"><span class="keyword">import</span> android.view.View;</span><br><span class="line"><span class="keyword">import</span> android.widget.AdapterView;</span><br><span class="line"><span class="keyword">import</span> android.widget.GridView;</span><br><span class="line"><span class="keyword">import</span> android.widget.ImageView;</span><br><span class="line"><span class="keyword">import</span> android.widget.SimpleAdapter;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.lang.ref.WeakReference;</span><br><span class="line"><span class="keyword">import</span> java.net.HttpURLConnection;</span><br><span class="line"><span class="keyword">import</span> java.net.URL;</span><br><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MainActivity</span> <span class="keyword">extends</span> <span class="title">AppCompatActivity</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String[] localCartoonText = &#123;<span class="string">"名侦探柯南"</span>, <span class="string">"死亡笔记"</span>, <span class="string">"火影忍者"</span>, <span class="string">"海贼王"</span>&#125;;</span><br><span class="line">    <span class="keyword">private</span> String[] imgURL =&#123;<span class="string">"http://img1.imgtn.bdimg.com/it/u=3350993068,3652800343&amp;fm=21&amp;gp=0.jpg"</span>, <span class="string">"http://img0.imgtn.bdimg.com/it/u=2545030489,2226096219&amp;fm=21&amp;gp=0.jpg"</span>, <span class="string">"http://img3.imgtn.bdimg.com/it/u=3171772449,1023293196&amp;fm=21&amp;gp=0.jpg"</span>, <span class="string">"http://img0.imgtn.bdimg.com/it/u=820734872,552500686&amp;fm=21&amp;gp=0.jpg"</span>&#125;;</span><br><span class="line">    <span class="keyword">private</span> GridView mGridView = <span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">private</span> GridViewAdapter mGridViewAdapter = <span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">private</span> ArrayList&lt;GridItem&gt; mGridData = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState);</span><br><span class="line">        setContentView(R.layout.activity_main);</span><br><span class="line"></span><br><span class="line">        mGridView = (GridView) findViewById(R.id.gridview_cartoon);</span><br><span class="line">        mGridData = <span class="keyword">new</span> ArrayList&lt;GridItem&gt;();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;imgURL.length; i++) &#123;</span><br><span class="line">            GridItem item = <span class="keyword">new</span> GridItem();</span><br><span class="line">            item.setTitle(localCartoonText[i]);</span><br><span class="line">            item.setImage(imgURL[i]);</span><br><span class="line">            mGridData.add(item);</span><br><span class="line">        &#125;</span><br><span class="line">        mGridViewAdapter = <span class="keyword">new</span> GridViewAdapter(<span class="keyword">this</span>, R.layout.grid_item, mGridData);</span><br><span class="line">        mGridView.setAdapter(mGridViewAdapter);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>我们在MainActivity中给数据适配器添加数据源，并绑定GridView，就像我们在第一小节所讲的步骤一样。另，如果想使用Picasso，在使用gradle管理的项目中，只需要在<code>build.gradle</code>文件中添加相关依赖就可以了。</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">dependencies &#123;</span><br><span class="line">    compile fileTree(<span class="string">dir:</span> <span class="string">'libs'</span>, <span class="string">include:</span> [<span class="string">'*.jar'</span>])</span><br><span class="line">    compile <span class="string">'com.android.support:appcompat-v7:23.1.1'</span></span><br><span class="line">    compile <span class="string">'com.squareup.picasso:picasso:2.5.2'</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>最后附上效果，经过短暂的下载，GridView可以成功使用相关图片的uri进行下载并显示。博主都是使用真机调试，所以这个屏幕截图可能看起来比较大，有点影响博客效果，也希望同志们见谅~下次再写blog时，我使用Genymotion给大家截图:)</p>
<p><img src="https://raw.githubusercontent.com/onlytjt/MarkdownSource/master/pic/Android2_4.png" alt="Android2_4" title="效果显示"></p>
<h5 id="3-Reference"><a href="#3-Reference" class="headerlink" title="3. Reference"></a>3. Reference</h5><p>(1) ViewHolder详解：<a href="http://jcodecraeer.com/a/anzhuokaifa/androidkaifa/2014/1021/1815.html" target="_blank" rel="external">http://jcodecraeer.com/a/anzhuokaifa/androidkaifa/2014/1021/1815.html</a>  </p>
<p>(2) inflate方法与findViewById：<a href="http://www.cnblogs.com/loyea/archive/2013/04/27/3047248.html" target="_blank" rel="external">http://www.cnblogs.com/loyea/archive/2013/04/27/3047248.html</a>  </p>
<p>(3) <a href="http://javatechig.com/android/download-and-display-image-in-android-gridview" target="_blank" rel="external">http://javatechig.com/android/download-and-display-image-in-android-gridview</a>  </p>
<hr>
<p><strong>By tjt</strong></p>
<p><strong>2015.12.09</strong></p>

          
        
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2015/12/02/Android1_VideoView/" itemprop="url">
                  Untitled
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">Posted on</span>
            <time itemprop="dateCreated" datetime="2015-12-02T15:28:59+08:00" content="2015-12-02">
              2015-12-02
            </time>
          </span>

          

          
            
          

          

          
          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="Android入门1：使用VideoView和MediController播放视频"><a href="#Android入门1：使用VideoView和MediController播放视频" class="headerlink" title="Android入门1：使用VideoView和MediController播放视频"></a>Android入门1：使用VideoView和MediController播放视频</h3><p>最近在搞Android，入门曲线还是挺陡峭的，主要还是自己对Java的理解不够深入。前后学习了几天，把最近学习到的一些知识点总结归纳一下，正所谓温故而知新。</p>
<p>目前想搞一个禁播视频站，主要内容都是一些大陆被墙的动漫啊，美剧啥的，比如我最爱的死亡笔记。内容不包含18禁的~感觉有些小伙伴要失望咯。</p>
<h5 id="1-Android入门素材"><a href="#1-Android入门素材" class="headerlink" title="1. Android入门素材"></a>1. Android入门素材</h5><p>以下罗列在我学习过程中使用的感觉还算不错的素材  </p>
<p>a. Official Android Training：developer.android.com/training/index.html  </p>
<p>b. 上述Android官方教程中文翻译版本：<a href="http://hukai.me/android-training-course-in-chinese/index.html" target="_blank" rel="external">http://hukai.me/android-training-course-in-chinese/index.html</a>  </p>
<p>c. imooc网站[Android攻城狮入门系列]：<a href="http://www.imooc.com/index/search?words=android" target="_blank" rel="external">http://www.imooc.com/index/search?words=android</a>  </p>
<p>d.《第一行代码-Android》pdf我放到自己的百度网盘里面，希望大家不要去告诉作者(笑)</p>
<p>链接: <a href="http://pan.baidu.com/s/1sjy3rw5" target="_blank" rel="external">http://pan.baidu.com/s/1sjy3rw5</a>  密码: 7gy6</p>
<h5 id="2-VideoView和MediaController介绍"><a href="#2-VideoView和MediaController介绍" class="headerlink" title="2. VideoView和MediaController介绍"></a>2. VideoView和MediaController介绍</h5><p>Android VideoView类为我们提供了十分方便的视频播放API，其主要方法有。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">start</span><span class="params">()</span>：开始播放</span><br><span class="line"><span class="keyword">void</span> <span class="title">stopPlayback</span><span class="params">()</span>：停止播放</span><br><span class="line"><span class="keyword">void</span> <span class="title">pause</span><span class="params">()</span>：暂停</span><br><span class="line"><span class="keyword">void</span> <span class="title">resume</span><span class="params">()</span>：重新播放</span><br><span class="line"><span class="keyword">void</span> <span class="title">seekTo</span><span class="params">(<span class="keyword">int</span> msec)</span>：从第几毫秒开始播放</span><br><span class="line"><span class="keyword">int</span> <span class="title">getCurrentPosition</span><span class="params">()</span>：获取当前播放的位置</span><br><span class="line"><span class="keyword">int</span> <span class="title">getDuration</span><span class="params">()</span>：获取当前播放视频的总长度</span><br><span class="line"><span class="keyword">boolean</span> <span class="title">isPlaying</span><span class="params">()</span>：当前VideoView是否在播放视频</span><br><span class="line"><span class="keyword">void</span> <span class="title">setVideoPath</span><span class="params">(String path)</span>：以文件路径的方式设置VideoView播放的视频源。</span><br><span class="line"><span class="keyword">void</span> <span class="title">setVideoURI</span><span class="params">(Uri uri)</span>：以Uri的方式设置视频源，可以是网络Uri或本地Uri。</span><br><span class="line"><span class="title">setMediaController</span><span class="params">(MediaController controller)</span>：设置MediaController控制器。</span><br><span class="line"><span class="title">setOnCompletionListener</span><span class="params">(MediaPlayer.onCompletionListener l)</span>：监听播放完成的事件。</span><br><span class="line"><span class="title">setOnErrorListener</span><span class="params">(MediaPlayer.OnErrorListener l)</span>：监听播放发生错误时候的事件。</span><br><span class="line"><span class="title">setOnPreparedListener</span><span class="params">(MediaPlayer.OnPreparedListener l)</span>：：监听视频装载完成的事件。</span></span><br></pre></td></tr></table></figure>
<p>除了简单的操作和丰富的API以外，我们在装载视频时，无需进行编码，播放完成后也无需手动回收资源。</p>
<p>除了播放视频，Media Controller类则为我们提供了一个悬浮的操作栏，包含了播放，暂停，快进，快退，上一个，下一个等功能键。甚至连拖动进度条至某处播放都已经实现，简直是业界良心。在使用前VideoView和MediController需要相互指定控件。其内置方法有。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">boolean</span> <span class="title">isShowing</span><span class="params">()</span>：当前悬浮控制栏是否显示。</span><br><span class="line"><span class="keyword">void</span> <span class="title">setMediaPlayer</span><span class="params">(MediaController.MediaPlayerControl player)</span>：设置控制的组件。</span><br><span class="line"><span class="keyword">void</span> <span class="title">setPrevNextListeners</span><span class="params">(View.OnClickListener next,View.OnClickListener prev)</span>：设置上一个视频、下一个视频的切换事件。</span></span><br></pre></td></tr></table></figure>
<p>默认情况下，Media Controller悬浮显示3s后隐藏，触摸响应的VideoView呼出。默认上一个，下一个按钮隐藏。</p>
<h5 id="3-播放视频Demo程序"><a href="#3-播放视频Demo程序" class="headerlink" title="3.播放视频Demo程序"></a>3.播放视频Demo程序</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.edu.sjtu.videoplayer.bannedvideoplayer;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> android.app.ProgressDialog;</span><br><span class="line"><span class="keyword">import</span> android.content.Intent;</span><br><span class="line"><span class="keyword">import</span> android.media.MediaPlayer;</span><br><span class="line"><span class="keyword">import</span> android.net.Uri;</span><br><span class="line"><span class="keyword">import</span> android.support.v7.app.AppCompatActivity;</span><br><span class="line"><span class="keyword">import</span> android.os.Bundle;</span><br><span class="line"><span class="keyword">import</span> android.util.Log;</span><br><span class="line"><span class="keyword">import</span> android.view.Menu;</span><br><span class="line"><span class="keyword">import</span> android.view.MenuItem;</span><br><span class="line"><span class="keyword">import</span> android.view.View;</span><br><span class="line"><span class="keyword">import</span> android.widget.*;</span><br><span class="line"><span class="keyword">import</span> java.io.File;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MainActivity</span> <span class="keyword">extends</span> <span class="title">AppCompatActivity</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> VideoView vv_videoview;</span><br><span class="line">    <span class="keyword">private</span> MediaController mController;</span><br><span class="line">    <span class="keyword">private</span> Button btn_play;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState);</span><br><span class="line">        setContentView(R.layout.activity_main);</span><br><span class="line"></span><br><span class="line">        btn_play = (Button) findViewById(R.id.btn_play);</span><br><span class="line">        vv_videoview = (VideoView) findViewById(R.id.vv_videoview);</span><br><span class="line">        mController = <span class="keyword">new</span> MediaController(<span class="keyword">this</span>);</span><br><span class="line"></span><br><span class="line">		<span class="comment">// Button响应事件，播放本地视频</span></span><br><span class="line">        btn_play.setOnClickListener(<span class="keyword">new</span> View.OnClickListener() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClick</span><span class="params">(View view)</span> </span>&#123;</span><br><span class="line">			<span class="comment">// Uri videoUri = Uri.parse("http://www.androidbegin.com/tutorial/AndroidCommercial.3gp");</span></span><br><span class="line">			<span class="comment">// vv_videoview.setVideoURI(videoUri);</span></span><br><span class="line">                File videoFile = <span class="keyword">new</span> File(<span class="string">"/sdcard/DCIM/Camera/test.mp4"</span>);</span><br><span class="line">                <span class="keyword">if</span> (videoFile.exists()) &#123;</span><br><span class="line">                    vv_videoview.setVideoPath(videoFile.getAbsolutePath());</span><br><span class="line">                    vv_videoview.setMediaController(mController);</span><br><span class="line">                    vv_videoview.start();</span><br><span class="line">                    vv_videoview.requestFocus();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">onCreateOptionsMenu</span><span class="params">(Menu menu)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// Inflate the menu; this adds items to the action bar if it is present.</span></span><br><span class="line">        getMenuInflater().inflate(R.menu.menu_main, menu);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">onOptionsItemSelected</span><span class="params">(MenuItem item)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// Handle action bar item clicks here. The action bar will</span></span><br><span class="line">        <span class="comment">// automatically handle clicks on the Home/Up button, so long</span></span><br><span class="line">        <span class="comment">// as you specify a parent activity in AndroidManifest.xml.</span></span><br><span class="line">        <span class="keyword">int</span> id = item.getItemId();</span><br><span class="line">        <span class="comment">//noinspection SimplifiableIfStatement</span></span><br><span class="line">        <span class="keyword">if</span> (id == R.id.action_settings) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">super</span>.onOptionsItemSelected(item);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Xml文件只有简单地一个Button和VideoView控件，节约篇幅就不上了，由于博主一直使用真机Debug，这里就不截图了。如果需要播放网络视频，只需要看我注释的两行，将<code>setVideoPath()</code>更改为相应的<code>setVideoURI()</code>就可以了。这里需要在AndroidManifest.xml添加两条权限。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">uses-permission</span> <span class="attr">android:name</span>=<span class="string">"android.permission.READ_EXTERNAL_STORAGE"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">uses-permission</span> <span class="attr">android:name</span>=<span class="string">"android.permission.INTERNET"</span> /&gt;</span></span><br></pre></td></tr></table></figure>
<p>这里需要多啰嗦的，也是经常会困惑刚入门同志的几个点。  </p>
<p>a. 增加的权限开头android.permission是小写的，Android Studio可能会默认补全为大写，导致没有相应权限。  </p>
<p>b. VideoView虽然可以播放网络视频，但是网络视频流实际是分为Http协议和RTSP(Real Time Streaming Protocal)两种。RTSP协议支持实时播放，而Http协议则需要缓冲一定时间才能够播放。  </p>
<p>c. 国内传统的视频站给出的URL并不是真实视频地址，因此像优酷，爱奇艺等网站的视频并不能直接使用VideoView播放。  </p>
<h5 id="4-Reference："><a href="#4-Reference：" class="headerlink" title="4. Reference："></a>4. Reference：</h5><p>a) <a href="http://www.androidbegin.com/tutorial/android-video-streaming-videoview-tutorial/" target="_blank" rel="external">http://www.androidbegin.com/tutorial/android-video-streaming-videoview-tutorial/</a>  </p>
<p>b) <a href="http://www.cnblogs.com/plokmju/p/android_videoview.html" target="_blank" rel="external">http://www.cnblogs.com/plokmju/p/android_videoview.html</a>  </p>
<hr>
<p><strong>By tjt</strong>  </p>
<p><strong>2015.12.02</strong></p>

          
        
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2015/11/17/OpenCV_Vimba/" itemprop="url">
                  Untitled
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">Posted on</span>
            <time itemprop="dateCreated" datetime="2015-11-17T19:17:57+08:00" content="2015-11-17">
              2015-11-17
            </time>
          </span>

          

          
            
          

          

          
          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="AVT-Vimba与OpenCV环境配置"><a href="#AVT-Vimba与OpenCV环境配置" class="headerlink" title="AVT Vimba与OpenCV环境配置"></a>AVT Vimba与OpenCV环境配置</h3><p>近来，由于项目需求，需要使用AVT的一款相机采集图像并进行相应的算法处理。环境的配置过程较为复杂，特此记录，以做备忘。也给有需要的小伙伴们一些key point的分享。</p>
<p><strong>搭建环境：Windows7 + Python2.7 + OpenCV3.0</strong></p>
<h5 id="1-Python2-7"><a href="#1-Python2-7" class="headerlink" title="1. Python2.7"></a>1. Python2.7</h5><p>由于平时的工作基本都是Mac或Linux平台，很少用到Windows，这次也把在Windows上面安装Python的过程做简单记录。</p>
<p>(1) 这里选择软件支持效果较好的Python2.7，<a href="https://www.python.org/downloads/" target="_blank" rel="external">Python官网</a>直接下载安装。</p>
<p>(2) 重量级的包管理器pip。<a href="https://pypi.python.org/pypi/pip" target="_blank" rel="external">Pip官网</a>下载二进制文件，解压到某个文件夹后，使用cmd进行安装。步骤是，cd到相应目录，输入<code>python setup.py install</code>。</p>
<p><img src="https://raw.githubusercontent.com/onlytjt/MarkdownSource/master/pic/Vimba_1.png" alt="安装pip"></p>
<p>(3) 安装完毕后使用pip工具安装一些相当有用的lib，比如numpy，scipy，matplotlib等等。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">pip install numpy</span><br><span class="line">pip install scipy</span><br><span class="line">pip install matplotlib</span><br></pre></td></tr></table></figure></p>
<h5 id="2-OpenCV3-0"><a href="#2-OpenCV3-0" class="headerlink" title="2. OpenCV3.0"></a>2. OpenCV3.0</h5><p>(1) 安装包在<a href="http://opencv.org/" target="_blank" rel="external">OpenCV官网</a>下载，网速原因，博主下载了好几次才成功。安装过程其实只是简单的解压缩。</p>
<p>(2) 由于使用Python API，进入OpenCV安装目录下<code>/build/python/2.7/cv2.pyd</code>。将cv2.pyd复制到Python安装目录下的<code>/Lib/site-packages/</code>。</p>
<p>至此就可以使用Python进行OpenCV的相关操作了。</p>
<h5 id="3-AVT-Vimba"><a href="#3-AVT-Vimba" class="headerlink" title="3. AVT Vimba"></a>3. AVT Vimba</h5><p>(1) <a href="https://www.alliedvision.com/en/products/software.html" target="_blank" rel="external">AVT官网</a>下载并安装。由于官方仅提供了C/C++的API，因此想使用Python的同学有几个选择：使用ctypes，或者使用pymba。</p>
<p>(2) 这里要感谢伟大的Github，给我们节约了无数的时间，也让我们能够学习到最先进的代码。pymba的Github地址，<a href="">https://github.com/morefigs/pymba</a>。这里安装过程同pip，下载解压到某个文件夹后，使用cmd shell，cd到相应目录，输入<code>python setup.py install</code>。</p>
<p><img src="https://raw.githubusercontent.com/onlytjt/MarkdownSource/master/pic/Vimba_2.png" alt="安装pymba"></p>
<p>(3) 这里要注意两点。一、pymba目前仅支持Vimba1.3的版本，因此下载更高版本的同学在后续使用过程中，可能会遇到各种Bug。二、在安装pymba之后，需要更改pymba默认索引的VimbaC.dll的路径。具体更改方法为找到<code>/pymba/vimbadll.py</code>将其中的Line13和Line16更改为自己VimbaC.dll的路径。我的如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vimbaC_path = r&apos;D:\Program Files\Allied Vision\Vimba_1.4\VimbaC\Bin\VimbaC.dll&apos;</span><br></pre></td></tr></table></figure></p>
<p>重新编译后，就可以尽情地在python中import了！哎~人生苦短，我用Python啊！</p>
<p>关于Vimba相关API的使用，建议查阅官方的Manual。关于cv2的使用，我后续还会持续更新，迫不及待的小伙伴，可以先自行Google。</p>
<p>最后，把我初步的代码附上，我尽可能地将注释写详细~<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 实现功能：驱动AVT相机，实时显示图像</span></span><br><span class="line"><span class="comment"># 时间：2015.11.17</span></span><br><span class="line"><span class="keyword">import</span> cv2</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">from</span> pymba <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CameraInterface</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self)</span>:</span></span><br><span class="line">        self.vimba = <span class="number">0</span></span><br><span class="line">        self.camera = <span class="number">0</span></span><br><span class="line">        self.cameraIds = <span class="number">0</span></span><br><span class="line">        self.frame0 = <span class="number">0</span></span><br><span class="line">        self.frame1 = <span class="number">0</span></span><br><span class="line">        self.moreUsefulImgData = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">openCamera</span><span class="params">(self)</span>:</span></span><br><span class="line">        self.vimba = Vimba()</span><br><span class="line">        self.vimba.startup()</span><br><span class="line">        <span class="keyword">print</span> <span class="string">"The Vimba lib version is:"</span>, self.vimba.getVersion(), <span class="string">", and vimba run successfully!"</span></span><br><span class="line">        system = self.vimba.getSystem()</span><br><span class="line"></span><br><span class="line">        <span class="comment"># list available cameras (after enabling discovery for GigE cameras)</span></span><br><span class="line">        system.runFeatureCommand(<span class="string">"GeVDiscoveryAllOnce"</span>)</span><br><span class="line">        time.sleep(<span class="number">0.2</span>)</span><br><span class="line">        self.cameraIds = self.vimba.getCameraIds()</span><br><span class="line">        <span class="keyword">print</span> <span class="string">"Available cameras"</span>, self.cameraIds</span><br><span class="line">        self.camera = self.vimba.getCamera(self.cameraIds[<span class="number">0</span>])</span><br><span class="line">        self.camera.openCamera()</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">setCameraFeature</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="comment"># show camera default features and set some features</span></span><br><span class="line">        <span class="comment">#cameraFeatureNames = camera.getFeatureNames()</span></span><br><span class="line">        <span class="comment">#print cameraFeatureName</span></span><br><span class="line">        <span class="keyword">print</span> self.camera.AcquisitionMode</span><br><span class="line">        self.camera.AcquisitionMode = <span class="string">'SingleFrame'</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># announce memory for frame</span></span><br><span class="line">        self.frame0 = self.camera.getFrame()</span><br><span class="line">        self.frame1 = self.camera.getFrame()</span><br><span class="line">        self.frame0.announceFrame()</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">captureFrame</span><span class="params">(self)</span>:</span></span><br><span class="line">        self.camera.startCapture()</span><br><span class="line">        self.frame0.queueFrameCapture()</span><br><span class="line">        self.camera.runFeatureCommand(<span class="string">'AcquisitionStart'</span>)</span><br><span class="line">        self.camera.runFeatureCommand(<span class="string">'AcquisitionStop'</span>)</span><br><span class="line">        self.frame0.waitFrameCapture()</span><br><span class="line"></span><br><span class="line">        imgData = self.frame0.getBufferByteData()</span><br><span class="line">        self.moreUsefulImgData = np.ndarray(buffer = self.frame0.getBufferByteData(), dtype = np.uint8, shape = (self.frame0.height, self.frame0.width, <span class="number">1</span>))</span><br><span class="line">        self.camera.endCapture()</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">showImage</span><span class="params">(self)</span>:</span></span><br><span class="line">        cv2.imshow(<span class="string">"Show Image"</span>, self.moreUsefulImgData)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">endShow</span><span class="params">(self)</span>:</span></span><br><span class="line">        cv2.destroyAllWindows()</span><br><span class="line">        self.vimba.shutdown()</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></span><br><span class="line">    ins = CameraInterface()</span><br><span class="line">    ins.openCamera()</span><br><span class="line">    ins.setCameraFeature()</span><br><span class="line">    <span class="keyword">while</span> <span class="keyword">True</span>:</span><br><span class="line">        ins.captureFrame()</span><br><span class="line">        ins.showImage()</span><br><span class="line">        <span class="keyword">if</span> cv2.waitKey(<span class="number">1</span>) == <span class="number">27</span>: <span class="comment"># press esc to quit</span></span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    ins.endShow()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure></p>
<hr>
<p><strong>By tjt</strong><br><strong>2015.11.17</strong></p>

          
        
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2015/09/02/Git_Remote/" itemprop="url">
                  Untitled
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">Posted on</span>
            <time itemprop="dateCreated" datetime="2015-09-02T19:40:54+08:00" content="2015-09-02">
              2015-09-02
            </time>
          </span>

          

          
            
          

          

          
          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="Git远程使用技巧"><a href="#Git远程使用技巧" class="headerlink" title="Git远程使用技巧"></a>Git远程使用技巧</h3><p>git作为强大的版本管理软件，已经得到了广泛的应用，很多人对于本地的git操作已经非常熟悉了。然而有的时候，我们也需要一个远程的，类似云的仓库来存储我们的一些代码。github给予了我们不限量的空间来使用，今天我也来简单地总结一下在git远程使用时经常会用到的一些命令与技巧。  </p>
<h5 id="1-初次连接本地与远程主机"><a href="#1-初次连接本地与远程主机" class="headerlink" title="1. 初次连接本地与远程主机"></a>1. 初次连接本地与远程主机</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">git init</span><br><span class="line">git add .</span><br><span class="line">git commit -m &quot;first commit&quot;</span><br><span class="line">git remote add origin git@github.com... // 将本地仓库与github连接，并创建远程主机origin</span><br><span class="line">git push origin master:master // 将本地master推送的远程origin/master</span><br></pre></td></tr></table></figure>
<h5 id="2-git-remote相关命令"><a href="#2-git-remote相关命令" class="headerlink" title="2. git remote相关命令"></a>2. git remote相关命令</h5><p>git要求每一个远程主机都要有一个独立的主机名，而git remote相关命令，就是用来管理主机名的。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">git remote 用来查看当前项目的所有主机名</span><br><span class="line">git remote -v 则可以显示主机名及其网址</span><br><span class="line">git remote show [主机名] 用来查看某个主机的详细信息</span><br><span class="line">git remote add [主机名][github网址] 用来添加一个远程主机</span><br><span class="line">git remote rm [主机名] 则会删除相应的主机</span><br></pre></td></tr></table></figure></p>
<h5 id="3-git-push相关命令"><a href="#3-git-push相关命令" class="headerlink" title="3. git push相关命令"></a>3. git push相关命令</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git push [远程主机名][本地分支名]:[远程分支名] 用于将本地提交内容推送到远程主机上</span><br><span class="line">git push [远程主机名] 将当前分支推送到远程主机的对应分支</span><br></pre></td></tr></table></figure>
<h5 id="4-git-pull"><a href="#4-git-pull" class="headerlink" title="4. git pull"></a>4. git pull</h5><p>由于git fetch在取回服务器上的程序更新时，还需要手动进行合并，对于一些小型的程序而言，git pull命令则更为实用。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git pull [远程主机名][远程分支名]:[本地分支名] 取回远程某个分支更新，并与本地指定分支合并</span><br><span class="line">git pull [远程主机名][远程分支名] 取回远程分支的更新，并与本地当前分支合并</span><br></pre></td></tr></table></figure></p>
<p>虽然以上命令都有相应的简化版本，但是做为一个版本管理软件，最为重要的特性是清晰地版本与分支管理。因此，我推荐使用完整的git命令，这会使大家对自己的代码版本架构有更清晰地理解。</p>
<h5 id="5-关于忽略同步一些文件"><a href="#5-关于忽略同步一些文件" class="headerlink" title="5. 关于忽略同步一些文件"></a>5. 关于忽略同步一些文件</h5><p>在使用git的时候，我们往往希望在同步过程中忽略一些涉及私人信息的文件，如使用Mac时的.DS_Store文件。此时也很简单，只需要添加名为<code>.gitignore</code>的文件并在其中添加相应的忽略文件即可。<br>这里的文件名使用通用的正则表达式进行匹配。</p>
<ul>
<li>斜杠”/“表示目录</li>
<li>星号”*”表示通配多个字符</li>
<li>问好”?”表示通配单个字符</li>
<li>方括号”[ ]”包含单个字符的匹配列表</li>
<li>叹号”!”表示不忽略匹配到得文件或目录</li>
</ul>
<p>关于正则表达式，不了解的读者可以戳<a href="http://baike.baidu.com/link?url=1mpBMLj2cGNyJVt4a3q8dequpHlfR-oCqBEhRDb4nLLLTMwy4aXbcxF1neUUkTNSlgT9R0yMIvhL4yZxmBrNZ_" target="_blank" rel="external">百度百科</a>，后面也许我会写一篇详细的文章介绍正则表达式，在coding中还是十分常用的。</p>
<p>git命令参考文章：<a href="http://www.ruanyifeng.com/blog/2014/06/git_remote.html" target="_blank" rel="external">http://www.ruanyifeng.com/blog/2014/06/git_remote.html</a></p>
<hr>
<p>By tjt<br>2015.09.06</p>

          
        
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2015/09/02/Qt_QtSerial/" itemprop="url">
                  Untitled
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">Posted on</span>
            <time itemprop="dateCreated" datetime="2015-09-02T18:28:28+08:00" content="2015-09-02">
              2015-09-02
            </time>
          </span>

          

          
            
          

          

          
          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="Qt串口通信"><a href="#Qt串口通信" class="headerlink" title="Qt串口通信"></a>Qt串口通信</h3><h5 id="1-Qt串口通信类QSerialPort"><a href="#1-Qt串口通信类QSerialPort" class="headerlink" title="1. Qt串口通信类QSerialPort"></a>1. Qt串口通信类QSerialPort</h5><p>在Qt5的的更新中，新增了串口通信的相关接口类QSerialPort，这使得在开发者在使用Qt进行UI开发时，可以更加简单有效地实现串口通信的相关功能。<br>开发者可以简单地通过<code>#include&lt;QSerialPort&gt;</code>，来使用系统包含的库函数。然而这里有一个非常容易忽略的问题，会导致编译时的报错。在使用QSerialPort类之前，需要在Qt的配置文件即.pro文件中添加<code>Qt += serialport</code>。</p>
<h5 id="2-代码示例"><a href="#2-代码示例" class="headerlink" title="2. 代码示例"></a>2. 代码示例</h5><p>a. 串口的初始化：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">QSerialPort *serial = new QSerialPort();</span><br><span class="line">QObject::connect(serial, SIGNAL(readyRead()), this, SLOT(recSerialData())); // 连接串口收到数据事件与读取数据函数</span><br><span class="line">serial-&gt;setPortName(&quot;COM3&quot;);</span><br><span class="line">serial-&gt;setBaudRate(QSerialPort::Baud9600);</span><br><span class="line">serial-&gt;setParity(QSerialPort::NoParity);</span><br><span class="line">serial-&gt;setDataBits(QSerialPort::Data8);</span><br><span class="line">serial-&gt;setStopBits(QSerialPort::OneStop);</span><br><span class="line">serial-&gt;setFlowControl(QSerialPort::NoFlowControl);</span><br><span class="line">if (serial-&gt;open(QIODevice::ReadWrite)) &#123;</span><br><span class="line">    qDebug()&lt;&lt;&quot;open success&quot;;</span><br><span class="line">&#125; else &#123;</span><br><span class="line">    qDebug()&lt;&lt;&quot;open failed&quot;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>b. 向串口发送数据<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">serial-&gt;write(&quot;test&quot;);</span><br></pre></td></tr></table></figure></p>
<p>c. 接收串口返回的数据<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">void MySerial::recSerialData()</span><br><span class="line">&#123;</span><br><span class="line">    QByteArray ba;</span><br><span class="line">    ba = serial-&gt;readAll();</span><br><span class="line">    display(ba);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h5 id="3-总结"><a href="#3-总结" class="headerlink" title="3. 总结"></a>3. 总结</h5><p>总的来说，使用Qt5进行串口通信是较为简单的。大致步骤为：配置串口参数-&gt;打开串口-&gt;收发数据。</p>
<h5 id="4-附录（Mac下的串口使用Tip）"><a href="#4-附录（Mac下的串口使用Tip）" class="headerlink" title="4. 附录（Mac下的串口使用Tip）"></a>4. 附录（Mac下的串口使用Tip）</h5><p>在Mac下使用串口，基本流程和步骤同Windows差异不是很大，但是有一些细节，还是想逼叨两句，让受到困扰的同志们少走弯路。<br>首先是串口驱动程序的下载和安装<a href="http://0xcf.com/2015/03/13/chinese-arduinos-with-ch340-ch341-serial-usb-chip-on-os-x-yosemite/" target="_blank" rel="external">CH341SER for Mac</a>。在安装完成后，由于OS X Yosemite10以后的版本，默认开机不加载第三方驱动程序，所以在驱动安装完成后，需要在terminal中输入<code>sudo nvram boot-args=”kext-dev-mode=1</code>来默认加载驱动程序。如果重启开机后，在网络设置中看到下图中的“USB2.0”，那么证明你的Mac安装串口驱动成功。<br><img src="https://raw.githubusercontent.com/onlytjt/MarkdownSource/master/pic/QtSerial_1.png" alt="pic_usb"></p>
<p>之后插入相应的设备，在terminal中输入<code>ls /dev/ | grep ch</code>则可以看到设备的名称，在串口初始化的步骤中进行更改<code>serial-&gt;setPortName(&quot;your-port-name&quot;);</code>，现在你就可以顺利地使用Mac进行串口的相关操作了！<br>Mac串口通信参考资料：<a href="http://0xcf.com/2015/03/13/chinese-arduinos-with-ch340-ch341-serial-usb-chip-on-os-x-yosemite/" target="_blank" rel="external">http://0xcf.com/2015/03/13/chinese-arduinos-with-ch340-ch341-serial-usb-chip-on-os-x-yosemite/</a>  </p>
<hr>
<p>By tjt<br>2015.09.02</p>

          
        
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  


          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel  sidebar-panel-active ">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/default_avatar.jpg"
               alt="Jiatian Tian" />
          <p class="site-author-name" itemprop="name">Jiatian Tian</p>
          <p class="site-description motion-element" itemprop="description"></p>
        </div>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">8</span>
              <span class="site-state-item-name">posts</span>
            </a>
          </div>

          

          

        </nav>

        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        <div class="links-of-blogroll motion-element">
          
        </div>

      </section>

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2016</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Jiatian Tian</span>
</div>

<div class="powered-by">
  Powered by <a class="theme-link" href="http://hexo.io">Hexo</a>
</div>

<div class="theme-info">
  Theme -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Muse
  </a>
</div>



      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  


  




<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>


  <script type="text/javascript" src="/vendors/jquery/index.js?v=2.1.3"></script>

  <script type="text/javascript" src="/vendors/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  <script type="text/javascript" src="/vendors/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  <script type="text/javascript" src="/vendors/velocity/velocity.min.js"></script>

  <script type="text/javascript" src="/vendors/velocity/velocity.ui.min.js"></script>

  <script type="text/javascript" src="/vendors/fancybox/source/jquery.fancybox.pack.js"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=0.5.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=0.5.0"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=0.5.0"></script>



  



  



  
  
  

  


</body>
</html>
